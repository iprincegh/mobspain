% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ml.R
\name{detect_outliers}
\alias{detect_outliers}
\title{Simple anomaly detection for users}
\usage{
detect_outliers(
  mobility_data,
  threshold = 2.5,
  spatial_zones = NULL,
  create_map = TRUE
)
}
\arguments{
\item{mobility_data}{Data frame with mobility data containing:
\itemize{
\item n_trips - Number of trips (numeric, required for anomaly detection)
\item date - Date of observation (optional)
\item id_origin - Origin zone identifier (optional, needed for spatial mapping)
\item Other columns are preserved in output
}}

\item{threshold}{Numeric. Z-score threshold for anomaly detection (default: 2.5).
Common values:
\itemize{
\item 2.0 - More sensitive (detects more anomalies)
\item 2.5 - Balanced (default, good for users)
\item 3.0 - Conservative (detects fewer, strong anomalies only)
}}

\item{spatial_zones}{sf object with spatial zones for creating maps (optional).
Use \code{get_spatial_zones()} to obtain. Required for spatial visualization.}

\item{create_map}{Logical. Whether to create spatial map if spatial_zones provided
(default: TRUE). Set to FALSE for faster processing without visualization.}
}
\value{
List containing:
\itemize{
\item anomalies - Data frame with original data plus anomaly flags
\item spatial_map - ggplot2 choropleth map showing anomaly zones (if spatial_zones provided)
\item summary - Summary statistics about detected anomalies
}
If no spatial_zones provided, returns only the anomalies data frame.
}
\description{
A simplified anomaly detection function focusing on statistical methods
that are easy to understand for users, with automatic spatial mapping
for spatial analysis applications.
}
\details{
This function uses statistical z-score method for anomaly detection:
\itemize{
\item Calculates z-scores for trip counts (standardized values)
\item Identifies observations with |z-score| > threshold as anomalies
\item Creates spatial maps showing anomaly rates by zone
\item Provides analytical messaging about the process
}

Z-scores represent how many standard deviations away from the mean each observation is.
This method is simple to understand and explain to users.
}
\examples{
\dontrun{
# Simple anomaly detection for users
mobility <- get_mobility_matrix(dates = "2023-01-01")
anomalies <- detect_simple_anomalies(mobility, threshold = 2.5)
summary(anomalies)

# With spatial mapping for analysis
zones <- get_spatial_zones("dist")
anomalies <- detect_simple_anomalies(
  mobility_data = mobility,
  threshold = 2.5,
  spatial_zones = zones,
  create_map = TRUE
)

# View anomalies and map
print(anomalies$summary)
print(anomalies$spatial_map)
head(anomalies$anomalies)

# Try different thresholds
strict_anomalies <- detect_simple_anomalies(mobility, threshold = 3.0)
loose_anomalies <- detect_simple_anomalies(mobility, threshold = 2.0)
}
}
