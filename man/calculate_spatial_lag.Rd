% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatial.R
\name{calculate_spatial_lag}
\alias{calculate_spatial_lag}
\title{Calculate spatial lag variables}
\usage{
calculate_spatial_lag(
  zones,
  variable,
  method = "contiguity",
  k = 5,
  max_distance_km = 20
)
}
\arguments{
\item{zones}{sf object with zone geometries and attributes}

\item{variable}{Character. Name of the variable to calculate spatial lag for}

\item{method}{Character. Method for spatial weights:
\itemize{
\item "contiguity" - Queen contiguity (default)
\item "distance" - Distance-based weights
\item "knn" - K-nearest neighbors
}}

\item{k}{Numeric. Number of neighbors for knn method (default: 5)}

\item{max_distance_km}{Numeric. Maximum distance for distance-based weights (default: 20km)}
}
\value{
Numeric vector with spatial lag values
}
\description{
Calculates spatial lag variables for zone attributes using spatial weights.
This is useful for spatial econometrics and analyzing spatial autocorrelation.
}
\details{
Implements best practices for spatial lag calculations:
\itemize{
\item Uses appropriate spatial weights matrices
\item Handles edge effects properly
\item Normalizes weights for consistency
\item Works with projected coordinates for accuracy
}
}
\examples{
\dontrun{
zones <- get_zones(level = "dist", region_filter = "Madrid")
zones$population <- runif(nrow(zones), 1000, 100000)  # Example data
zones$pop_spatial_lag <- calculate_spatial_lag(zones, "population", method = "contiguity")
}
}
